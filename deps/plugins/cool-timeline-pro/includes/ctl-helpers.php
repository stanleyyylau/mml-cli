<?phpfunction get_cool_timeline_template($template_name = 'timeline-container') {      switch ($template_name) {        default:        case 'single-story-content':            $file_name = 'single-cool-timeline-content';            break;    }    // check for and load file    if (file_exists(get_stylesheet_directory() . '/cool-timeline/' . $file_name . '.php')) {        include( get_stylesheet_directory() . '/cool-timeline/' . $file_name . '.php' );        return;    }    include(COOL_TIMELINE_PLUGIN_DIR . 'includes/' . $file_name . '.php' );}function ctl_get_story_date($post_id) {    $ctl_story_date = get_post_meta($post_id, 'ctl_story_date', true);    if ($ctl_story_date) {        if (preg_match("/\d{4}/", $ctl_story_date, $match)) {            $year = intval($match[0]); //converting the year to integer            if ($year >= 1970) {                $posted_date = date("M d , Y", strtotime("$ctl_story_date"));            } else {                $date = date_create($ctl_story_date);                if (!$date) {                    $e = date_get_last_errors();                    foreach ($e['errors'] as $error) {                        return "$error\n";                    }                    exit(1);                }                $posted_date = date_format($date, __("M d , Y", 'cool-timeline'));            }        }        return  $posted_date;    }}function custom_pagination($numpages = '', $pagerange = '', $paged='') {    if (empty($pagerange)) {        $pagerange = 2;    }    global $paged;    if (empty($paged)) {        $paged = 1;    }    if ($numpages == '') {        global $wp_query;        $numpages = $wp_query->max_num_pages;        if(!$numpages) {            $numpages = 1;        }    }    $big = 999999999;     $of_lbl = __( ' of ', 'cool-timeline' );     $page_lbl = __( ' Page ', 'cool-timeline' );     $pagination_args = array(        'base' => str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),        'format' => '?paged=%#%',        'total'           => $numpages,        'current'         => $paged,        'show_all'        => False,        'end_size'        => 1,        'mid_size'        => $pagerange,        'prev_next'       => True,        'prev_text'       => __('&laquo;'),        'next_text'       => __('&raquo;'),        'type'            => 'plain',        'add_args'        => false,        'add_fragment'    => ''    );    $paginate_links = paginate_links($pagination_args);    $ctl_pagi='';    if ($paginate_links) {        $ctl_pagi .= "<nav class='custom-pagination'>";        $ctl_pagi .= "<span class='page-numbers page-num'> ".$page_lbl . $paged . $of_lbl . $numpages . "</span> ";        $ctl_pagi .= $paginate_links;        $ctl_pagi .= "</nav>";        return $ctl_pagi;    }}function get_current_post_type() {    global $post, $typenow, $current_screen;     if ( $post && $post->post_type )        return $post->post_type;      elseif( $typenow )        return $typenow;       elseif( $current_screen && $current_screen->post_type )        return $current_screen->post_type;      elseif( isset( $_REQUEST['post_type'] ) )        return sanitize_key( $_REQUEST['post_type'] );      return null;}function get_related_stories($post_id){    if($post_id){     $terms = get_the_terms($post_id, 'ctl-stories');      $ctl_options_arr = get_option('cool_timeline_options');  //  var_dump($terms[0]->name);     $rel_stories='';                if (!empty($terms) && !is_wp_error($terms)) {                    foreach ($terms as $term) {                        $term_id = $term->term_id;                        $args = array(                            'tax_query' => array(                                array(                                    'taxonomy' => 'ctl-stories',                                    'field' => 'term_id',                                    'terms' => $term_id,                                )),                            'post_type' => 'cool_timeline',                            'order' => 'DESC',                            'post__not_in' => array(get_the_ID()),                            'posts_per_page' => 5,                        );                        $my_query = null;                        $my_query = new WP_Query($args);                        if ($my_query->have_posts()) {                            $i = 0;                                                        $rel_stories.='<ul class="ctl-related-stories">';                            while ($my_query->have_posts()) : $my_query->the_post();                             if ($i % 2 == 0) {                            $even_odd = "even";                             }                             else{                              $even_odd = "odd";                             }                            $rel_stories.='<li>                                    <div class="ctl-related-stories-badge info-'.$even_odd.'"><i class="fa fa-circle"></i></div>                                    <div class="ctl-related-stories-panel">                                        <div class="ctl-related-stories-heading">                                            <time class="ctl-related-stories-title">'. ctl_get_story_date(get_the_ID()).'</time>                                        </div>                                        <div class="ctl-related-stories-body">                                            <h4>  <a href="'.get_the_permalink().'">'. get_the_title().'</a></h4>                                        </div>                                    </div></li>';                            $i++;                            endwhile;                           $rel_stories.='</ul>';                            wp_reset_postdata();                        }                    }                     if(isset($terms[0]->name) && !empty($terms[0]->name)){                         $r_title=$terms[0]->name;                        if($r_title=="Timeline Stories"){                            $rel_title =$ctl_options_arr['title_text'];                            }else{                               $rel_title=$r_title;                            }                    }else{                           $ctl_title_text = $ctl_options_arr['title_text'];                           $rel_title=$ctl_title_text;                    }                        $rel_h_html='<h2>'.$rel_title.'</h2>';                    echo  $rel_h_html.$rel_stories;                }        }             }if ( ! function_exists( 'ctl_entry_taxonomies' ) ) :      function ctl_entry_taxonomies() {        $categories_list = get_the_category_list( _x( ', ', 'Used between list items, there is a space after the comma.', 'cool-timeline' ) );        $cat_meta='';        if ( $categories_list) {            $cat_meta .= sprintf( '<i class="fa fa-folder-open" aria-hidden="true"></i><span class="cat-links"><span class="screen-reader-text">%1$s </span>%2$s</span>',                _x( 'Categories', 'Used before category names.', 'cool-timeline' ),                $categories_list            );        }        return $cat_meta;    }endif;function ctl_post_tags() {    $tags_list = get_the_tag_list( '', _x( ', ', 'Used between list items, there is a space after the comma.', 'cool-timeline' ) );    if ( $tags_list ) {        return sprintf( '<span class="tags-links"><i class="fa fa-bookmark"></i><span class="screen-reader-text">%1$s </span>%2$s</span>',            _x( 'Tags', 'Used before tag names.', 'cool-timeline' ),            $tags_list        );    }}?>